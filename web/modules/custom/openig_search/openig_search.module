<?php

/**
 * Implements hook_theme().
 */
function openig_search_theme() {
    return [
        'openig_search_results' => [
            'variables' => [
                'items' => [],
                'facets' => [],
                'filters' => [],
                'pager' => [],
                'page' => '',
                'count' => '',
                'url' => '',
                'pathSearchInternal' => '',
                'pathSearchExternal' => '',
                'search_filter_form' => '',
                'nbResultats'        => '',
                'ressourceInterne'   => null,
            ],
        ],
        'openig_search_internal_results' => [
            'variables' => [
              'pathSearchInternal' => '',
              'pathSearchExternal' => '',
              'nbResultats'        => '',
              'ressourceInterne'   => null,
            ],
        ],
    ];
}

function openig_search_preprocess_openig_search_results(&$variables) {
    $variables['#attached']['library'][] = 'openig_search/openig-search';
}

function openig_search_views_pre_render(\Drupal\views\ViewExecutable $view){
  if (isset($view) && ($view->storage->id() == 'resultats_de_recherche')) {
    $view->element['#attached']['library'][] = 'openig_search/openig-search';
  }
}


function openig_search_preprocess(&$variables, $hook) {
  // Add images path alias
  $variables['images_path'] = \Drupal::request()->getSchemeAndHttpHost() . '/' . \Drupal::service('extension.list.module')->getPath('openig_search') . '/images/';
}


function openig_search_form_alter(&$form, &$form_state, $form_id) {
  if($form['#id'] === "views-exposed-form-resultats-de-recherche-block-filter-search-internal" ||
    $form['#id'] === "views-exposed-form-resultats-de-recherche-block-1"){
    $form['#action'] = '/recherche';
  }
}
